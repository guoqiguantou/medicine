{"version":3,"sources":["webpack:///./src/pages/mine/posterDetail/posterDetail.tsx","webpack:///./src/pages/mine/posterDetail/posterDetail.less","webpack:///./src/pages/mine/posterDetail/posterDetail.tsx?1bdd","webpack:///./src/utils/base64.tsx"],"names":["_btnArr","type","text","PosterDetail","dispatch","props","mine","posterInfo","invateUrlInfo","mineInfo","useState","backImg","setBackImg","showSetting","setShowSetting","useEffect","payload","res","id","getUU","qr","qrCode","_ress","Base64","url","subInfo1","encodeAndMark","word","y","startX","_name","numX","subInfo12","x","color","subInfo13","subInfo2","subInfo3","fontSize","info","saveImage","Taro","common","title","src","_savePic2Local","imgOp","scope","err","success","refusedAuthInfo","JSON","filePath","path","_opt","_item","data","item","loading","_keyStr","encode","input","output","chr1","chr2","chr3","enc1","enc2","enc3","enc4","i","_utf8_encode","length","charCodeAt","isNaN","charAt","decode","replace","indexOf","String","fromCharCode","_utf8_decode","string","utftext","n","c","c1","c2","c3"],"mappings":"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","file":"pages/mine/posterDetail/posterDetail.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from 'react-redux';\nimport { Button, Image, View } from \"@tarojs/components\";\nimport Taro from '@tarojs/taro';\nimport './posterDetail.less';\nimport { PosterDetailProps } from \"./posterDetailInterface\";\nimport NavBar from \"@/components/NavBar\";\nimport common from \"@/utils/common\";\nimport Base64 from '../../../utils/base64';\n\n\nconst _btnArr = [{ type: '3', text: '保存海报' }, { type: '4', text: '复制链接' }];\n\n\nconst PosterDetail: React.FC<PosterDetailProps> = (props) => {\n\n  const { dispatch, mine } = props;\n  const { posterInfo, invateUrlInfo, mineInfo } = mine;\n\n  const [backImg, setBackImg] = useState('');\n  const [showSetting, setShowSetting] = useState(false);\n\n  useEffect(() => {\n    dispatch({ type: 'mine/querySharePoster', payload: { type: 5 } });\n    dispatch({ type: 'mine/queryAuntMine' }).then(res => {\n      if (res && res.id) {\n        dispatch({ type: 'mine/getInviteUrl', payload: { id: res.id } });\n      }\n    })\n  }, []);\n\n\n  useEffect(() => {\n    invateUrlInfo.qrCode && posterInfo.picUrl && getUU()\n  }, [invateUrlInfo.qrCode, posterInfo.picUrl]);\n\n\n  // 拼图\n  const getUU = (qr = invateUrlInfo.qrCode) => {\n    let _ress = Base64.encode(qr.substring(qr.indexOf(\"kacloud\")) + \"?x-oss-process=image/resize,m_fill,w_150,h_150\")\n      .replace(/\\+/g, \"-\").replace(/\\//g, '_');\n\n    let url = posterInfo.picUrl + '?x-oss-process=image/resize,m_fill,w_500,h_890' + \"/watermark,image_\" + _ress + \",x_25,y_55\";\n\n    const subInfo1 = encodeAndMark({ word: `好友 `, y: 150, });\n\n    let startX = 80; // 第二列 起始x\n    let _name = mineInfo.name || '';\n    let numX = 21 * _name.length;  // 文字的 宽度\n\n    let subInfo12 = '';\n    if (_name) {\n      subInfo12 = encodeAndMark({ word: `${_name || ''}`, y: 150, x: startX, color: 'DD4650' });\n    }\n    let subInfo13 = encodeAndMark({ word: ` 邀请您加入`, y: 150, x: (startX + numX), });\n\n    if (mineInfo.shopName && mineInfo.shopName.length > 13) {\n      const subInfo2 = encodeAndMark({ word: mineInfo.shopName.substring(0, 13), y: 110, color: 'DD4650' });\n      const subInfo3 = encodeAndMark({ word: mineInfo.shopName.substring(13), y: 80, color: 'DD4650' });\n      url = url + subInfo1 + subInfo12 + subInfo13 + subInfo2 + subInfo3;\n    } else {\n      const subInfo2 = encodeAndMark({ word: mineInfo.shopName.substring(0, 13), y: 110, color: 'DD4650' });\n      url = url + subInfo1 + subInfo12 + subInfo13 + subInfo2;\n    }\n\n    setBackImg(url);\n  }\n\n  const encodeAndMark = ({ word = '', x = 32, y = 110, color = '666666', fontSize = '22' } = {}) => {\n    const info = Base64.encode(`${word}`).replace(/\\+/g, \"-\").replace(/\\//g, '_');\n    return `/watermark,text_${info},color_${color},size_${fontSize},g_sw,x_${x},y_${y}`;\n  }\n\n  // 保存图片\n  const saveImage = () => {\n\n    // 查看是否授权\n    Taro.getSetting({})\n      .then(res => {\n\n        if (!backImg) return common.error('图片地址有误');\n        Taro.showLoading({ title: '获取图片资源.....' });\n\n        // 获取网络图片信息  顺便转为本地临时图片\n        Taro.getImageInfo({\n          src: backImg,\n        }).then((imgOp) => {\n\n          // 有相册权限直接保存\n          if (res.authSetting['scope.writePhotosAlbum']) {\n            _savePic2Local(imgOp.path)\n          } else {\n\n            // 获取权限\n            Taro.authorize({\n              scope: 'scope.writePhotosAlbum',\n            }).then(() => {\n              _savePic2Local(imgOp.path)\n            }).catch(err => {\n              // 没有权限 打开设置面板\n              if (err && err.errMsg && err.errMsg.indexOf('auth deny') > 0) {\n                Taro.openSetting({\n                  success(res) {\n                    Taro.hideLoading();\n                    res.authSetting = { \"scope.writePhotosAlbum\": true }\n                  },\n                }).catch(errRefu => {\n                  refusedAuthInfo(errRefu)\n                })\n              }\n\n            })\n          }\n\n        })\n\n      }).catch((e) => {\n      Taro.hideLoading();\n      common.error(`保存图片失败：${JSON.stringify(e)}`)\n    })\n  }\n\n  // 判断用户是否拒绝读取相册权限\n  const refusedAuthInfo = (err) => {\n    Taro.hideLoading();\n    if (err && err.errMsg && err.errMsg.indexOf('openSetting:fail') > -1) {\n      /*Taro.showModal({\n        title: '温馨提示',\n        content: '您拒绝了访问相册权限，无法保存海报，若想使用，请手动前往设置页面打开允许访问相册的设置'\n      });*/\n      setShowSetting(true)\n    } else {\n      common.error(JSON.stringify(err))\n    }\n  };\n\n  // 保存图片到本地\n  const _savePic2Local = (path) => {\n    Taro.saveImageToPhotosAlbum({\n      filePath: path\n    }).then(() => {\n      Taro.hideLoading();\n      return common.error('保存成功')\n    }).catch(err => {\n      Taro.hideLoading();\n      if (err && err.errMsg && err.errMsg.indexOf('fail cancel') > 0) {\n        return common.error('取消保存')\n      }\n    })\n  };\n\n\n  const _opt = (_item) => {\n    if (_item.type == '3') return saveImage();\n    if (!invateUrlInfo.url) return common.error('分享链接未获取');\n    if (_item.type == '4') {\n      return Taro.setClipboardData({\n        data: invateUrlInfo.url,\n        success() {\n          common.error('链接复制成功，请到微信发送给好友吧', 2500)\n        }\n      })\n    }\n  };\n\n  return <View className=\"poster\">\n\n    <NavBar title=\"海报详情\" />\n\n    <View className=\"pos-1\">\n      <View className=\"pos-15\">\n        <Image src={backImg || posterInfo.picUrl} className=\"pos-2\" />\n        <View className=\"pos-16\">请将邀请海报保存到本地后发送给好友</View>\n      </View>\n    </View>\n\n    <View className=\"pos-3\">\n\n      <View className=\"pos-5\">\n        <View className=\"pos-7\" />\n        <View className=\"pos-8\">分享到</View>\n      </View>\n\n      <View className=\"pos-6\">\n        {\n          _btnArr.map(item =>\n            <View className=\"pos-9\" key={item.type} onClick={() => _opt(item)}>\n              <Image src={`https://oss.bm001.com/static/ka/a/share/share${item.type}.svg`} className=\"pos-10\" />\n              <View className=\"pos-11\">{item.text}</View>\n            </View>\n          )\n        }\n      </View>\n    </View>\n\n    {\n      showSetting && <View className=\"bu\">\n        <View className=\"bu1\">\n          <View className=\"bu-title\">{'温馨提示'}</View>\n          <View className=\"bu-content\">您拒绝了访问相册权限，无法保存海报，若想使用，请手动前往设置页面打开允许访问相册的设置</View>\n          <View className=\"bu-bt-bx\">\n            <Button\n              className='btn-st'\n              onClick={() => setShowSetting(false)}\n            >取 消</Button>\n            <Button\n              className='btn-st'\n              onOpenSetting={() => setShowSetting(false)}\n              openType={\"openSetting\"}\n            >确 定</Button>\n          </View>\n        </View>\n      </View>\n    }\n\n  </View>\n\n}\n\nexport default connect(({ mine, dispatch, loading }) => ({\n  mine,\n  dispatch,\n  loading: loading.effects['findAunt/auntPossibleAdd'],\n}))(PosterDetail);\n","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../../node_modules/@tarojs/mini-runner/node_modules/babel-loader/lib/index.js!./posterDetail.tsx\"\nvar config = {\"navigationBarTitleText\":\"推荐记录\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/mine/posterDetail/posterDetail', {}, config || {}))\n\n","const _keyStr = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\nlet Base64 = {\n    //public method for encoding\n    encode: (input: string) => {\n        var output = \"\", chr1, chr2, chr3, enc1, enc2, enc3, enc4, i = 0;\n        input = Base64._utf8_encode(input);\n        while (i < input.length) {\n            chr1 = input.charCodeAt(i++);\n            chr2 = input.charCodeAt(i++);\n            chr3 = input.charCodeAt(i++);\n            enc1 = chr1 >> 2;\n            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n            enc4 = chr3 & 63;\n            if (isNaN(chr2)) {\n                enc3 = enc4 = 64;\n            } else if (isNaN(chr3)) {\n                enc4 = 64;\n            }\n            output = output +\n                _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +\n                _keyStr.charAt(enc3) + _keyStr.charAt(enc4);\n        }\n        return output;\n    },\n\n    // public method for decoding\n    decode: (input: string) => {\n        var output = \"\", chr1, chr2, chr3, enc1, enc2, enc3, enc4, i = 0;\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n        while (i < input.length) {\n            enc1 = _keyStr.indexOf(input.charAt(i++));\n            enc2 = _keyStr.indexOf(input.charAt(i++));\n            enc3 = _keyStr.indexOf(input.charAt(i++));\n            enc4 = _keyStr.indexOf(input.charAt(i++));\n            chr1 = (enc1 << 2) | (enc2 >> 4);\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n            chr3 = ((enc3 & 3) << 6) | enc4;\n            output = output + String.fromCharCode(chr1);\n            if (enc3 != 64) {\n                output = output + String.fromCharCode(chr2);\n            }\n            if (enc4 != 64) {\n                output = output + String.fromCharCode(chr3);\n            }\n        }\n        output = Base64._utf8_decode(output);\n        return output;\n    },\n\n    // private method for UTF-8 encoding\n    _utf8_encode: (string: string) => {\n        string = string.replace(/\\r\\n/g, \"\\n\");\n        var utftext = \"\";\n        for (var n = 0; n < string.length; n++) {\n            var c = string.charCodeAt(n);\n            if (c < 128) {\n                utftext += String.fromCharCode(c);\n            } else if ((c > 127) && (c < 2048)) {\n                utftext += String.fromCharCode((c >> 6) | 192);\n                utftext += String.fromCharCode((c & 63) | 128);\n            } else {\n                utftext += String.fromCharCode((c >> 12) | 224);\n                utftext += String.fromCharCode(((c >> 6) & 63) | 128);\n                utftext += String.fromCharCode((c & 63) | 128);\n            }\n\n        }\n        return utftext;\n    },\n\n    // private method for UTF-8 decoding\n    _utf8_decode: (utftext: string) => {\n        var string = \"\", i = 0, c = 0, c1 = 0, c2 = 0, c3 = 0;\n        while (i < utftext.length) {\n            c = utftext.charCodeAt(i);\n            if (c < 128) {\n                string += String.fromCharCode(c);\n                i++;\n            } else if ((c > 191) && (c < 224)) {\n                c2 = utftext.charCodeAt(i + 1);\n                string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n                i += 2;\n            } else {\n                c2 = utftext.charCodeAt(i + 1);\n                c3 = utftext.charCodeAt(i + 2);\n                string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n                i += 3;\n            }\n        }\n        return string;\n    }\n}\n\nexport default Base64;"],"sourceRoot":""}