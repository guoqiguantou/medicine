{"version":3,"sources":["webpack:///./src/pages/service/detail.tsx","webpack:///./src/assets/images/location.png","webpack:///./src/pages/service/components/ModalImg/index.less","webpack:///./src/pages/service/components/ModalImg/index.tsx","webpack:///./src/pages/service/components/ModalSign/index.less","webpack:///./src/pages/service/components/ModalSign/index.tsx","webpack:///./src/pages/service/components/Timer/index.tsx","webpack:///./src/pages/service/detail.tsx?58fd","webpack:///./src/wx/getLocation.js"],"names":["ServiceDetail","forwardRef","useState","state","setStates","dispatch","props","cleanOrder","ModalSignRef","useRef","show","useEffect","id","Taro","type","payload","console","step","images","classnames","moment","saveImgs","service","ModalUploadImg","item","urls","previewImage","current","setState","isOpened","confirmImg","onChange","propsfileList","nextProps","length","title","icon","disabled","max","map","onImageClick","open","uploadImgChange","handleConfirm","Component","ModalSign","ref","setIsOpened","isReload","setIsReload","isAuth","setIsAuth","maxLength","remark","address","formItem","setFormItem","submit","useImperativeHandle","reload","useDidShow","flag","getEnv","getSetting","success","res","authSetting","undefined","showToast","getLocation","WxGetLocation","latitude","longitude","distance","types","then","province","city","catch","value","Tips","showTips","handleChange","name","reloadBtn","Location","e","Timer","format","Date","signTime","setSignTime","timer","setInterval","clearInterval","ENV","error","window","wx","checkJsApi","jsApiList","checkResult","location","fail","log","errMsg","indexOf"],"mappings":"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","file":"pages/service/detail.js","sourcesContent":["import React, { FC, useEffect, forwardRef, useState, useRef } from 'react';\nimport Taro from '@tarojs/taro';\nimport { connect } from 'react-redux';\nimport { View, Text } from '@tarojs/components';\nimport { AtDivider } from 'taro-ui';\nimport NavBar from '@/components/NavBar';\nimport Card from '@/components/Card';\nimport moment from 'moment';\nimport ModalImg from './components/ModalImg';\nimport ModalSign, { ModalSignRefType } from './components/ModalSign';\nimport Timer from './components/Timer'\nimport classnames from 'classnames';\nimport './service.less';\n\ninterface ServiceDetailProps {\n  service;\n  dispatch;\n}\n\n/**服务单详情页面*/\nconst ServiceDetail: FC<ServiceDetailProps> = forwardRef((props: ServiceDetailProps, ref) => {\n  let [state, setStates] = useState<number>(0); //0上户签到 1下户签到 2签到完成\n  const { dispatch, service: { cleanOrder } } = props;\n  const ModalSignRef: React.MutableRefObject<ModalSignRefType> = useRef({\n    show() { },\n  });\n\n  useEffect(() => {\n    const { id } = Taro.getCurrentInstance()!.router!.params;\n    dispatch({\n      type: 'service/getCleanOrder',\n      payload: { id },\n    });\n    return () => {\n      dispatch({\n        type: 'service/clearDetail',\n      });\n    };\n  }, []);\n\n  useEffect(() => {\n    if (cleanOrder.startWorkSignTime && cleanOrder.endWorkSignTime) {\n      setStates(2);\n    } else if (cleanOrder.startWorkSignTime) {\n      setStates(1);\n    } else {\n      setStates(0);\n    }\n  }, [cleanOrder]);\n\n  //签到\n  function submit(data) {\n\n    const { id } = Taro.getCurrentInstance()!.router!.params;\n    if (state == 0) {\n      dispatch({\n        type: 'service/startWorkSign',\n        payload: { id, ...data },\n      });\n    } else if (state == 1) {\n      dispatch({\n        type: 'service/endWorkSign',\n        payload: { id, ...data },\n      });\n    }\n  }\n  //上传图片\n  function saveImgs(images: string[], step: number) {\n    console.log(images);\n    const { id } = Taro.getCurrentInstance()!.router!.params;\n    if (step == 1) {\n      dispatch({\n        type: 'service/saveStartWorkImgs',\n        payload: { id, images },\n      });\n    } else if (step == 2) {\n      dispatch({\n        type: 'service/saveEndWorkImgs',\n        payload: { id, images },\n      });\n    }\n  }\n  return (\n    <View className=\"serviceDetail\">\n      <NavBar title=\"服务单详情\" />\n      <View className=\"detailTop\">\n        {(cleanOrder?.state == 0 ||\n          cleanOrder?.startWorkSignTime ||\n          cleanOrder?.endWorkSignTime) && (\n            <View className=\"detailTop\">\n              <Card>\n                {cleanOrder.state == 0 && (\n                  <View\n                    className={classnames([\n                      'sign',\n                      state < 2 ? 'yellow' : 'grey',\n                    ])}\n                    onClick={() => {\n                      state < 2 && ModalSignRef.current.show();\n                    }}\n                  >\n                    <Text className=\"signName\">\n                      {{ 0: '上户签到', 1: '下户签到', 2: '签到完成' }[state]}\n                    </Text>\n                    {state < 2 && (\n                      <Text className=\"signTime\">\n                        <Timer format=\"HH:mm:ss\" />\n                      </Text>\n                    )}\n                  </View>\n                )}\n                {cleanOrder?.startWorkSignTime && (\n                  <View className=\"signDetail\">\n                    <Text className=\"signDetailText\">上户签到</Text>\n                    <View className=\"listItem\">\n                      <Text className=\"listTitle\">签到时间:</Text>\n                      <View className=\"listText\">\n                        {cleanOrder?.startWorkSignTime &&\n                          moment(cleanOrder?.startWorkSignTime).format(\n                            'YYYY.MM.DD HH:mm',\n                          )}\n                      </View>\n                    </View>\n                    <View className=\"listItem\">\n                      <Text className=\"listTitle\">签到地点:</Text>\n                      <View className=\"listText\">\n                        {cleanOrder?.startWorkSignAddress || ''}\n                      </View>\n                    </View>\n                    {cleanOrder?.startWorkSignRemark && <View className=\"listItem\">\n                      <Text className=\"listTitle\">备注:</Text>\n                      <View className=\"listText\">{cleanOrder?.startWorkSignRemark || ''}</View>\n                    </View>}\n                  </View>\n                )}\n                {cleanOrder?.endWorkSignTime && (\n                  <React.Fragment>\n                    <AtDivider lineColor=\"#f5f5f5\" />\n                    <View className=\"signDetail\">\n                      <Text className=\"signDetailText\">下户签到</Text>\n                      <View className=\"listItem\">\n                        <Text className=\"listTitle\">签到时间:</Text>\n                        <View className=\"listText\">\n                          {cleanOrder?.endWorkSignTime &&\n                            moment(cleanOrder?.endWorkSignTime).format(\n                              'YYYY.MM.DD HH:mm',\n                            )}\n                        </View>\n                      </View>\n                      <View className=\"listItem\">\n                        <Text className=\"listTitle\">签到地点:</Text>\n                        <View className=\"listText\">\n                          {cleanOrder?.endWorkSignAddress || ''}\n                        </View>\n                      </View>\n                      {cleanOrder?.endWorkSignRemark && <View className=\"listItem\">\n                        <Text className=\"listTitle\">备注:</Text>\n                        <View className=\"listText\">{cleanOrder?.endWorkSignRemark || ''}</View>\n                      </View>}\n                    </View>\n                  </React.Fragment>\n                )}\n              </Card>\n            </View>\n          )}\n        {((cleanOrder?.startWorkImgs || []).length > 0 ||\n          (cleanOrder?.endWorkImgs || []).length > 0 ||\n          cleanOrder.state == 0) && (\n            <Card title=\"照片留样\">\n              <ModalImg\n                title=\"未做之前照片\"\n                propsfileList={cleanOrder?.startWorkImgs || []}\n                onChange={img => {\n                  saveImgs(img, 1);\n                }}\n                disabled={cleanOrder.state !== 0}\n              />\n              <AtDivider lineColor=\"#f5f5f5\" className=\"MyAtDivider\" />\n              <ModalImg\n                title=\"做完之后照片\"\n                propsfileList={cleanOrder?.endWorkImgs || []}\n                onChange={img => {\n                  saveImgs(img, 2);\n                }}\n                disabled={cleanOrder.state !== 0}\n              />\n            </Card>\n          )}\n        <Card>\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">服务单号:</Text>\n            <View className=\"listText\">{cleanOrder?.cleanOrderId || ''}</View>\n          </View>\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">客户姓名:</Text>\n            <View className=\"listText\">\n              {cleanOrder?.cleanServiceOrderVO?.customerName || ''}\n            </View>\n          </View>\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">服务地址:</Text>\n            <View className=\"listText\">\n              {cleanOrder?.province || ''}\n              {cleanOrder?.city || ''}\n              {cleanOrder?.district || ''}\n              {cleanOrder?.address || ''}\n            </View>\n          </View>\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">商品名称:</Text>\n            <View className=\"listText\">\n              {cleanOrder?.cleanServiceOrderVO?.productName || ''}\n            </View>\n          </View>\n          {cleanOrder?.cleanServiceOrderVO?.productAttrValueName && (\n            <View className=\"listItem\">\n              <Text className=\"listTitle\">商品规格:</Text>\n              <View className=\"listText\">\n                {cleanOrder?.cleanServiceOrderVO?.productAttrValueName || ''}\n              </View>\n            </View>\n          )}\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">上门时间:</Text>\n            <View className=\"listText\">\n              {cleanOrder?.serviceTime &&\n                moment(cleanOrder?.serviceTime).format('YYYY.MM.DD HH:mm')}\n            </View>\n          </View>\n          {cleanOrder?.cleanServiceOrderVO?.notes && (\n            <View className=\"listItem\">\n              <Text className=\"listTitle\">注意事项:</Text>\n              <View className=\"listText\">\n                {cleanOrder?.cleanServiceOrderVO?.notes || ''}\n              </View>\n            </View>\n          )}\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">服务状态:</Text>\n            <View className=\"listText\">\n              {{ 0: '未完成', 1: '已完成', 2: '已取消' }[cleanOrder.state]}\n            </View>\n          </View>\n          {cleanOrder?.cleanServiceOrderVO?.closeReason && (\n            <View className=\"listItem\">\n              <Text className=\"listTitle\">取消原因:</Text>\n              <View className=\"listText\">\n                {cleanOrder?.cleanServiceOrderVO?.closeReason || ''}\n              </View>\n            </View>\n          )}\n          {cleanOrder?.cleanServiceOrderVO?.closeTime && (\n            <View className=\"listItem\">\n              <Text className=\"listTitle\">取消时间:</Text>\n              <View className=\"listText\">\n                {cleanOrder?.cleanServiceOrderVO?.closeTime &&\n                  moment(cleanOrder?.cleanServiceOrderVO?.closeTime).format(\n                    'YYYY.MM.DD HH:mm',\n                  )}\n              </View>\n            </View>\n          )}\n        </Card>\n        <ModalSign ref={ModalSignRef} submit={submit} title={state == 0 ? '上户签到' : '下户签到'} dispatch={dispatch} />\n      </View>\n    </View>\n  );\n},\n);\n\nexport default connect(({ service, dispatch }) => ({\n  service,\n  dispatch,\n}))(ServiceDetail);\n","export default __webpack_public_path__ + \"assets/images/location.png\";","// extracted by mini-css-extract-plugin","import Taro from '@tarojs/taro';\nimport React, { Component } from 'react';\nimport { View, Text, Image, Button } from '@tarojs/components';\nimport {\n  AtIcon,\n  AtModal,\n  AtModalHeader,\n  AtModalContent,\n  AtButton,\n} from 'taro-ui';\nimport UploadImg from '@/components/UploadImg';\nimport classnames from 'classnames';\n// import '@/components/uploadImg/index.less';\nimport './index.less';\n\ninterface ModalUploadImgProps {\n  title?: string;\n  icon?: string;\n  onChange?;\n  propsfileList?: string[];\n  disabled?: boolean;\n}\ninterface ModalUploadImgState {\n  images: string[];\n  confirmImg: string[];\n  isOpened: boolean;\n}\n\n//modal上传图片\nexport default class ModalUploadImg extends Component<\n  ModalUploadImgProps,\n  ModalUploadImgState\n  > {\n  constructor(props) {\n    super(props);\n    this.state = {\n      images: [],\n      isOpened: false,\n      confirmImg: props.propsfileList || [],\n    };\n  }\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.propsfileList.length !== this.state.confirmImg.length) {\n      this.setState({\n        confirmImg: [...nextProps.propsfileList],\n      });\n    }\n  }\n\n  onImageClick = (item: string, urls: string[]) => {\n    Taro.previewImage({\n      current: item, // 当前显示图片的http链接\n      urls: urls, // 需要预览的图片http链接列表\n    });\n  };\n  uploadImgChange = images => {\n    this.setState({\n      images,\n    });\n  };\n  open = () => {\n    this.setState({\n      isOpened: true,\n      images: [...this.state.confirmImg],\n    });\n  };\n  handleConfirm = () => {\n    this.setState(\n      {\n        isOpened: false,\n        confirmImg: this.state.images,\n      },\n      () => {\n        this.props.onChange && this.props.onChange(this.state.images);\n      },\n    );\n  };\n  render() {\n    let { images, isOpened, confirmImg } = this.state;\n    let { title = '添加照片', icon, disabled = false } = this.props;\n    const max = 20;\n    return (\n      <View className=\"uploadModal\">\n        <View className=\"upload\">\n          {confirmImg.length > 0 ? (\n            <View>\n              <Text className=\"uploadText\">{title}:</Text>\n              <View className=\"uploadList at-row at-row--wrap\">\n                {confirmImg.map(item => {\n                  return (\n                    <View className=\"at-col at-col-4 uploadItem\" key={item}>\n                      <View className=\"uploadImg\">\n                        <Image\n                          onClick={() => {\n                            this.onImageClick(item, confirmImg);\n                          }}\n                          lazyLoad\n                          src={item}\n                          className=\"upload-image\"\n                          mode=\"aspectFill\"\n                        />\n                      </View>\n                    </View>\n                  );\n                })}\n                {!disabled && !(max && images.length >= max) && (\n                  <View className=\"at-col at-col-4 uploadItem \">\n                    <View className=\"uploadImg\">\n                      <View className=\"uploadAdd\" onClick={this.open}>\n                        <AtIcon value=\"camera\" size=\"34\" color=\"#F2544E\" />\n                        <Text className=\"uploadText\">上传图片</Text>\n                      </View>\n                    </View>\n                  </View>\n                )}\n              </View>\n            </View>\n          ) : (\n              !disabled && (\n                <View className=\"uploadView\">\n                  <View className=\"pic\" onClick={this.open}>\n                    <View className=\"picTitle\">\n                      <Text\n                        className={classnames([\n                          'iconfont',\n                          'picIcon',\n                          icon || 'icontianjiazhaopian',\n                        ])}\n                      ></Text>\n                      <Text>{title}</Text>\n                    </View>\n                    <Text className=\"picInfo\">点击打开相册或相机</Text>\n                  </View>\n                </View>\n              )\n            )}\n        </View>\n        <AtModal\n          isOpened={isOpened}\n          className=\"BmModal\"\n          onClose={() => {\n            this.setState({ isOpened: false });\n          }}\n        >\n          <AtModalHeader>\n            上传{title}({images.length}/{max})\n            <View className=\"closeBtn\">\n              <AtIcon value='close' size='22' color='#666666' onClick={() => { this.setState({ isOpened: false }); }}></AtIcon>\n            </View>\n          </AtModalHeader>\n          <AtModalContent>\n            <UploadImg\n              propsfileList={images}\n              onChange={this.uploadImgChange}\n              title=\"上传照片\"\n              max={max}\n            />\n          </AtModalContent>\n          <AtButton\n            onClick={this.handleConfirm}\n            type=\"primary\"\n            disabled={images.length == 0}\n            className=\"loginBtn\"\n          >\n            提交\n          </AtButton>\n        </AtModal>\n      </View>\n    );\n  }\n}\n","// extracted by mini-css-extract-plugin","import React, {\n  FC,\n  useState,\n  forwardRef,\n  useImperativeHandle\n} from 'react';\nimport Taro, { useDidShow } from '@tarojs/taro';\nimport { View, Text, Image, Button } from '@tarojs/components';\nimport {\n  AtModal,\n  AtTextarea,\n  AtModalHeader,\n  AtModalContent,\n  AtButton,\n  AtActivityIndicator,\n  AtIcon\n} from 'taro-ui';\nimport './index.less';\nimport Location from '@/images/location.png';\nimport Timer from '../Timer';\nimport Tips from '@/utils/tip'\nimport WxGetLocation from '@/wx/getLocation'\n\ninterface ModalSignProps {\n  title?: string;\n  submit?;\n  ref?;\n  dispatch?;\n}\n\nexport interface ModalSignRefType {\n  show: Function;\n}\n\n//modal签到\nconst ModalSign: FC<ModalSignProps> = forwardRef(\n  (props: ModalSignProps, ref: React.MutableRefObject<ModalSignRefType>) => {\n    const [isOpened, setIsOpened] = useState(false);\n    const [isReload, setIsReload] = useState(false);\n    const [isAuth, setIsAuth] = useState(true);\n    const maxLength = 200;\n    let [formItem, setFormItem] = useState({\n      remark: '',\n      address: '',\n    });\n    let { title = '上户签到', submit, dispatch } = props;\n    // 抛出方法\n    useImperativeHandle(ref, () => ({\n      show: () => {\n        reload(true);\n        setIsOpened(true);\n      },\n    }));\n\n    useDidShow(() => {\n      isOpened && reload()\n    })\n\n    function reload(flag: boolean = false) {\n      if (Taro.getEnv() === 'WEAPP') {\n        Taro.getSetting({\n          success: (res) => {\n            setIsAuth(!!res.authSetting['scope.userLocation'])\n            if (res.authSetting['scope.userLocation'] != undefined && res.authSetting['scope.userLocation'] != true) {\n              // 已授权已拒绝\n              Taro.showToast({\n                title: '需要获取您的地理位置，请点击重新定位',\n                icon: 'none'\n              })\n            } else if (res.authSetting['scope.userLocation'] == undefined) {\n              //未授权\n              getLocation(flag)\n            } else {\n              //已授权已同意\n              getLocation(flag)\n            }\n          }\n        })\n      }\n      if (Taro.getEnv() === 'WEB') {\n        getLocation(flag)\n      }\n    }\n    function getLocation(flag: boolean = false) {\n      WxGetLocation((res) => {\n        setIsReload(true);\n        setIsAuth(true)\n        dispatch({\n          type: 'service/geocode',\n          payload: {\n            latitude: res.latitude,\n            longitude: res.longitude,\n            distance: 10000,\n            types: \"120300\"\n          },\n        }).then(res => {\n          setIsReload(false);\n          setFormItem({\n            ...formItem,\n            address: res[0] ? res[0].province + res[0].city + res[0].distance + res[0].address : '',\n            ...(flag && { remark: '' }),\n          });\n        }).catch((value) => {\n          Tips.showTips(value)\n        });\n      }, () => {\n        Taro.showToast({\n          title: '需要获取您的地理位置，请点击重新定位',\n          icon: 'none'\n        })\n      })\n    }\n    function handleConfirm() {\n      if (formItem.remark && formItem.remark.length > maxLength) {\n        Tips.showTips(`备注不能超过${maxLength}个字哦～`)\n        return false;\n      }\n      setIsOpened(false);\n      submit && submit({ address: formItem.address, remark: formItem.remark });\n    }\n    //修改表单值\n    function handleChange(name, value) {\n      setFormItem({ ...formItem, [name]: value });\n    }\n\n    function reloadBtn() {\n      return isReload ? (\n        <AtActivityIndicator\n          isOpened={true}\n          content=\"定位中...\"\n          color=\"#F2544E\"\n          size={32}\n          className=\"loading\"\n        />\n      ) : (\n          <View>\n            <Image src={Location} className=\"listTimeImg\" />\n            <View className=\"listTime\" onClick={() => { reload(false) }}>\n              <Text>重新定位</Text>\n              {!isAuth && <Button openType=\"openSetting\" className=\"authBtn\">去设置</Button>}\n            </View>\n          </View>\n        )\n    }\n    return (\n      <AtModal\n        isOpened={isOpened}\n        className=\"BmModal\"\n        onClose={() => {\n          setIsOpened(false);\n        }}\n      >\n        <AtModalHeader>\n          {title}\n          <View className=\"closeBtn\">\n            <AtIcon value='close' size='22' color='#666666' onClick={() => { setIsOpened(false); }}></AtIcon>\n          </View>\n        </AtModalHeader>\n        <AtModalContent>\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">签到时间:</Text>\n            <View className=\"listText\">\n              <Timer />\n            </View>\n          </View>\n          <View className=\"listItem\">\n            <Text className=\"listTitle\">签到地点:</Text>\n            <View className=\"listText\">\n              {formItem.address}\n              {reloadBtn()}\n            </View>\n          </View>\n          <View className=\"textareaView\" >\n            {isOpened && (\n              <AtTextarea\n                value={formItem.remark}\n                fixed={true}\n                maxLength={maxLength}\n                className=\"textarea\"\n                placeholder=\"请填写备注\"\n                onChange={e => {\n                  handleChange('remark', e);\n                }}\n                height={200}\n                cursorSpacing={20}\n              />\n            )}\n          </View>\n        </AtModalContent>\n        <AtButton onClick={handleConfirm} type=\"primary\" className=\"loginBtn\">\n          提交\n        </AtButton>\n      </AtModal>\n    );\n  },\n);\nexport default ModalSign;\n","import React, { FC, useState, useEffect } from 'react';\nimport { Text } from '@tarojs/components';\nimport moment from 'moment';\n\ninterface TimerProps {\n    format?: string\n}\n\nconst Timer: FC<TimerProps> = (props) => {\n    const { format = \"YYYY.MM.DD HH:mm:ss\" } = props;\n    const [signTime, setSignTime] = useState(new Date());\n\n    useEffect(() => {\n        let timer;\n        timer = setInterval(() => {\n            setSignTime(new Date());\n        }, 1000);\n        return () => {\n            timer && clearInterval(timer);\n        };\n    }, []);\n\n    return (\n        <Text>{signTime && moment(signTime).format(format)}</Text>\n    );\n}\nexport default Timer;\n","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/mini-runner/node_modules/babel-loader/lib/index.js!./detail.tsx\"\nvar config = {\"navigationBarTitleText\":\"服务单详情\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/service/detail', {}, config || {}))\n\n","import Taro from '@tarojs/taro';\n\nconst ENV = Taro.getEnv();\n\n\nexport default function (success, error) {\n  if (ENV === 'WEB') {\n    window.wx.checkJsApi({\n      jsApiList: ['getLocation'], // 需要检测的JS接口列表，所有JS接口列表见附录2,\n      success: function (res) {\n        const { getLocation: location } = res.checkResult || {};\n        if (location) {\n          window.wx.getLocation({\n            type: 'gcj02', // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'\n            success: function (res) {\n              success && success(res);\n            },\n          });\n        } else {\n          error && error('无权限获取地理位置');\n        }\n      },\n      fail: (res) => {\n        error && error('无权限获取地理位置');\n      }\n    });\n  } else if (ENV === 'WEAPP') {\n    Taro.getLocation({\n      type: 'gcj02', //返回可以用于 Taro.openLocation的经纬度\n      success: (res) => {\n        success && success(res);\n      },\n      fail: (res) => {\n        console.log('location err ', res);\n        if (res.errMsg.indexOf('auth deny') !== -1) {\n          error && error(res);\n        }\n      },\n    });\n  }\n\n\n}\n"],"sourceRoot":""}